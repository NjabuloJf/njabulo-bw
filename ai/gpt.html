<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT-4 AI Dashboard</title>
    <style>
        :root {
            --primary: #10a37f;
            --primary-dark: #0d8c6c;
            --gradient-start: #10a37f;
            --gradient-end: #1a73e8;
            --bg-light: #ffffff;
            --bg-dark: #0f0f0f;
            --text-light: #202124;
            --text-dark: #e8eaed;
            --user-bubble: #10a37f;
            --ai-bubble: #1a1a1a;
            --border-light: #dadce0;
            --border-dark: #3c4043;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-light);
            color: var(--text-light);
            height: 100vh;
            overflow: hidden;
        }

        body.dark-mode {
            background: var(--bg-dark);
            color: var(--text-dark);
        }

        .dashboard {
            display: flex;
            height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 80px;
            background: var(--bg-light);
            border-right: 1px solid var(--border-light);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
        }

        body.dark-mode .sidebar {
            background: var(--bg-dark);
            border-right-color: var(--border-dark);
        }

        .logo {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-bottom: 30px;
        }

        .nav-item {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px 0;
            cursor: pointer;
            font-size: 20px;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(16, 163, 127, 0.1);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        body.dark-mode .chat-header {
            border-bottom-color: var(--border-dark);
        }

        .header-title {
            font-size: 18px;
            font-weight: bold;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .theme-toggle {
            background: none;
            border: 1px solid var(--border-light);
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
        }

        /* Chat Messages */
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .message {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            flex-shrink: 0;
        }

        .user-avatar {
            background: var(--user-bubble);
        }

        .ai-avatar {
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
        }

        .message-content {
            flex: 1;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 5px;
        }

        .message-time {
            font-size: 12px;
            opacity: 0.7;
        }

        .message-text {
            line-height: 1.6;
        }

        .message-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .action-btn {
            background: none;
            border: 1px solid var(--border-light);
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        /* Chat Input */
        .chat-input-container {
            padding: 20px;
            border-top: 1px solid var(--border-light);
        }

        body.dark-mode .chat-input-container {
            border-top-color: var(--border-dark);
        }

        .chat-input-wrapper {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .chat-input {
            flex: 1;
            padding: 15px;
            border: 1px solid var(--border-light);
            border-radius: 10px;
            font-size: 16px;
            font-family: inherit;
            resize: none;
            min-height: 60px;
            max-height: 120px;
        }

        body.dark-mode .chat-input {
            background: var(--bg-dark);
            color: var(--text-dark);
            border-color: var(--border-dark);
        }

        .send-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
        }

        .send-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .quick-btn {
            padding: 8px 16px;
            background: rgba(16, 163, 127, 0.1);
            border: 1px solid var(--primary);
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            color: var(--primary);
        }

        /* API Debug Info */
        .api-debug {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 20px;
            font-size: 14px;
        }

        body.dark-mode .api-debug {
            background: #332701;
            border-color: #665200;
        }

        .debug-toggle {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">GPT</div>
            <div class="nav-item active" title="Chat">üí¨</div>
            <div class="nav-item" title="Settings">‚öôÔ∏è</div>
            <div class="nav-item" id="themeToggle" title="Toggle Theme">üåô</div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="chat-header">
                <div class="header-title">GPT-4 Chat Assistant</div>
                <button class="theme-toggle" id="themeBtn">Toggle Theme</button>
            </div>

            <!-- API Debug Info -->
            <div class="api-debug" id="apiDebug">
                <strong>üîß API Status:</strong> 
                <span id="apiStatus">Testing connection...</span>
                <button class="debug-toggle" onclick="testAPI()">Test API</button>
                <div style="margin-top: 8px; font-size: 12px;" id="apiDetails"></div>
            </div>

            <!-- Chat Messages -->
            <div class="chat-messages" id="chatMessages">
                <div class="message">
                    <div class="avatar ai-avatar">AI</div>
                    <div class="message-content">
                        <div class="message-header">
                            <strong>GPT-4 Assistant</strong>
                            <span class="message-time" id="currentTime"></span>
                        </div>
                        <div class="message-text">
                            Hello! I'm your GPT-4 assistant. How can I help you today?
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Input -->
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <textarea 
                        class="chat-input" 
                        id="messageInput" 
                        placeholder="Type your message here... (If API doesn't work, I'll show demo responses)"
                        rows="1"
                    ></textarea>
                    <button class="send-btn" id="sendBtn" onclick="sendMessage()">Send</button>
                </div>
                <div class="quick-actions">
                    <button class="quick-btn" onclick="askQuickQuestion('Hello, how are you?')">Say Hello</button>
                    <button class="quick-btn" onclick="askQuickQuestion('What can you do?')">Capabilities</button>
                    <button class="quick-btn" onclick="askQuickQuestion('Tell me a joke')">Tell a Joke</button>
                    <button class="quick-btn" onclick="askQuickQuestion('Explain AI')">Explain AI</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Set current time
        document.getElementById('currentTime').textContent = new Date().toLocaleTimeString();

        // Theme Toggle
        const themeBtn = document.getElementById('themeBtn');
        const themeToggle = document.getElementById('themeToggle');
        
        themeBtn.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
        });
        
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
        });

        // Auto-resize textarea
        const messageInput = document.getElementById('messageInput');
        messageInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });

        // Enter key to send
        messageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // API Test Function
        async function testAPI() {
            const apiStatus = document.getElementById('apiStatus');
            const apiDetails = document.getElementById('apiDetails');
            
            apiStatus.innerHTML = 'üîÑ Testing API connection...';
            apiDetails.innerHTML = 'Sending request to: https://api.giftedtech.co.ke/api/ai/gpt4';
            
            try {
                const testMessage = 'Hello, are you working?';
                const response = await fetch(`https://api.giftedtech.co.ke/api/ai/gpt4?apikey=gifted&q=${encodeURIComponent(testMessage)}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.response) {
                    apiStatus.innerHTML = '‚úÖ API is working!';
                    apiDetails.innerHTML = `Response: "${data.response.substring(0, 50)}..."`;
                } else {
                    apiStatus.innerHTML = '‚ö†Ô∏è API responded but no message';
                    apiDetails.innerHTML = 'Response format might be different than expected';
                }
                
            } catch (error) {
                apiStatus.innerHTML = '‚ùå API connection failed';
                apiDetails.innerHTML = `Error: ${error.message}`;
            }
        }

        // Demo responses for when API fails
        const demoResponses = [
            "I'm GPT-4, an AI assistant created by OpenAI. I can help you with various tasks like answering questions, writing content, coding, and more!",
            "Hello! I'm doing well, thank you for asking. How can I assist you today?",
            "Why don't scientists trust atoms? Because they make up everything! üòÑ",
            "Artificial Intelligence (AI) refers to the simulation of human intelligence in machines that are programmed to think and learn like humans.",
            "I can help you with writing, analysis, problem-solving, coding, creative tasks, research, and much more. What would you like to work on?",
            "The weather today looks perfect for learning something new! What would you like to explore?",
            "Programming is like learning a new language - it takes practice but opens up amazing possibilities!",
            "I'm here to help 24/7. Feel free to ask me anything from simple questions to complex problems."
        ];

        let responseIndex = 0;

        // Main chat function
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (!message) return;

            // Add user message
            addMessage(message, 'user');
            input.value = '';
            input.style.height = 'auto';

            // Disable send button
            document.getElementById('sendBtn').disabled = true;

            // Show typing indicator
            const typingId = showTypingIndicator();

            try {
                // Try to call the API
                const response = await fetch(`https://api.giftedtech.co.ke/api/ai/gpt4?apikey=gifted&q=${encodeURIComponent(message)}`);
                
                if (response.ok) {
                    const data = await response.json();
                    removeTypingIndicator(typingId);
                    addMessage(data.response || 'I received your message but got an empty response.', 'ai');
                } else {
                    throw new Error('API returned error status');
                }
                
            } catch (error) {
                // If API fails, use demo response
                removeTypingIndicator(typingId);
                const demoResponse = demoResponses[responseIndex % demoResponses.length];
                addMessage(demoResponse, 'ai');
                responseIndex++;
                
                // Show API error in debug info
                document.getElementById('apiStatus').innerHTML = '‚ùå Using demo mode (API failed)';
                document.getElementById('apiDetails').innerHTML = `Real API error: ${error.message}. Showing demo responses instead.`;
            }

            // Re-enable send button
            document.getElementById('sendBtn').disabled = false;
        }

        function askQuickQuestion(question) {
            document.getElementById('messageInput').value = question;
            sendMessage();
        }

        function addMessage(text, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            const timestamp = new Date().toLocaleTimeString();
            const avatar = sender === 'user' ? 'You' : 'AI';
            const avatarClass = sender === 'user' ? 'user-avatar' : 'ai-avatar';
            
            messageDiv.innerHTML = `
                <div class="avatar ${avatarClass}">${avatar}</div>
                <div class="message-content">
                    <div class="message-header">
                        <strong>${sender === 'user' ? 'You' : 'GPT-4'}</strong>
                        <span class="message-time">${timestamp}</span>
                    </div>
                    <div class="message-text">${text}</div>
                    <div class="message-actions">
                        <button class="action-btn" onclick="copyMessage(this)">Copy</button>
                        ${sender === 'ai' ? '<button class="action-btn" onclick="markImportant(this)">‚≠ê</button>' : ''}
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function showTypingIndicator() {
            const messagesContainer = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message';
            typingDiv.id = 'typing-indicator';
            
            typingDiv.innerHTML = `
                <div class="avatar ai-avatar">AI</div>
                <div class="message-content">
                    <div class="message-header">
                        <strong>GPT-4</strong>
                        <span class="message-time">typing...</span>
                    </div>
                    <div class="message-text">üîÑ Thinking...</div>
                </div>
            `;
            
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            return 'typing-indicator';
        }

        function removeTypingIndicator(id) {
            const element = document.getElementById(id);
            if (element) {
                element.remove();
            }
        }

        function copyMessage(button) {
            const messageText = button.closest('.message-content').querySelector('.message-text').textContent;
            navigator.clipboard.writeText(messageText).then(() => {
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = 'Copy';
                }, 2000);
            });
        }

        function markImportant(button) {
            button.textContent = '‚≠ê Marked';
            setTimeout(() => {
                button.textContent = '‚≠ê';
            }, 2000);
        }

        // Test API on load
        window.addEventListener('load', () => {
            setTimeout(testAPI, 1000);
            messageInput.focus();
        });
    </script>
</body>
</html>
